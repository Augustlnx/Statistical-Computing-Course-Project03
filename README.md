# 统计计算课程设计03——0-1膨胀负二项回归模型的贝叶斯参数估计

## 项目简介及报告预览

本项目基于贝叶斯方法，针对**0-1膨胀负二项回归模型**（ZOINB）的参数估计问题展开研究，使用**Gibbs抽样**与**Metropolis-Hastings**（M-H）算法对模型参数进行推断，并结合模拟数据验证方法的有效性。

完整项目报告请阅读飞书文档：[0-1膨胀负二项回归模型的贝叶斯参数估计](https://g15zouwoip.feishu.cn/docx/Et4ydl6S8o2v0exSuP2cqXbjn3c)

![image](https://github.com/user-attachments/assets/4348f064-1e37-4b37-8f09-4f28e4024e0f)


## 项目背景
- **问题描述**：由Pprofessor提供的数据集包含400个独立样本，响应变量 $Y_i$ 存在0-1膨胀现象（由伯努利分布和负二项分布混合生成），任务是估计参数 $\beta_0, \beta_1, \beta_2, \phi, \pi_0, p$。
- **模型结构**：
  - 观测值 $Y_i$ 由隐变量 $D_i$ 决定来源： $D_i=0$ 时来自伯努利分布 $M_i$ ， $D_i=1$ 时来自负二项分布 $Z_i$ 。
  - 回归关系： $\log(\mu_i) = \beta_0 + X_{i1}\beta_1 + X_{i2}\beta_2$  ，其中 $\mu_i$ 为负二项分布的均值。

---

## 方法框架
### 1. 贝叶斯推断与抽样算法
- **先验设定**：
  - $\beta$：多元正态分布
  - $\phi$：Gamma分布
  - $\pi_0, p$：均匀分布
- **抽样策略**：
  - **Gibbs抽样**：用于 $\pi_0$和 $p$（Beta后验）以及隐变量 $D, M, Z$的更新。
  - **M-H算法**：用于 $\beta$和 $\phi$的抽样（因后验分布非标准形式）。
  - **Pólya-Gamma潜变量**：优化 $\beta$的抽样效率（条件高斯形式）。

### 2. 实验设计
- **模拟数据生成**：基于预设参数生成测试数据，验证估计方法的可靠性。
- **单参数测试**：控制其他参数为真值，评估隐含变量（ $D, M, Z$）和关键参数（ $\beta, \phi$）的估计效果。
- **全参数估计**：结合完整Gibbs抽样链，分析收敛性与偏差。

---

## 核心结论
### 1. 参数估计效果
- **$\beta$（回归系数）**：
  - M-H算法估计接近真实值（如 $\beta_0$误差<0.1%），但自相关性较高。
  - Pólya-Gamma方法计算效率高，但存在系统性偏差（需进一步理论修正）。
- ** $\phi$（过离散参数）**：
  - 收敛性较差，需长链迭代（>50,000次），后验均值偏离真值约15%（如 $\phi=4$时估计为4.57）。
- **$\pi_0$和 $p$**：
  - 准确率>90%，后验分布接近正态，收敛速度快。

### 2. 隐变量更新
- **$D_i$（来源标签）**：对 $Y_i=0/1$的样本划分准确率约73%。
- **$M_i$和 $Z_i$**： $M_i$的准确率达91%，但 $Z_i$的均方误差较高（MSE≈20.24），表明计数部分的估计不确定性较大。

### 3. 方法对比
- **M-H vs. Pólya-Gamma**：前者稳定性高，后者计算快但需理论调整。
- **两阶段Gibbs（CRT）**：对 $\phi$的估计效果不显著，可能与模型假设冲突。

---

## 收敛性判定的可视化支持
- **轨迹图**：展示参数迭代过程，验证收敛性（如 $\beta$和 $\pi_0$的均值稳定）。
- **密度图**：后验分布形态分析（如 $p$接近对称正态分布）。
- **自相关图**：M-H算法的自相关性显著，需Thinning策略优化。


**注**：完整实验细节与代码实现请参考项目文档与代码仓库。
